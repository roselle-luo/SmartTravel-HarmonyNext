import { App, display, Prompt } from "@kit.ArkUI";

interface ListItemInfo {
  image: Resource;
  title: string;
  description: string;
}

// ExplorePage.ets
@Component
export struct HomePage {
  @State swiperIndex: number = 0;
  @State deviceWidth: number = 0;
  @State maxCount: number = 1;
  private recommendedImages: string[] = [
    'https://p3.img.cctvpic.com/photoworkspace/contentimg/2019/05/05/2019050515335593405.jpg', // ç¤ºä¾‹å›¾ç‰‡URL
    'https://askthescientists.com/wp-content/uploads/2018/07/Outdoors-AdobeStock_203673414-835x418.jpg', // ç¤ºä¾‹å›¾ç‰‡URL
    'https://cxfile.advences.com/CFAVOYAGES/photo/shutterstock_638541712.jpg'// ç¤ºä¾‹å›¾ç‰‡URL
  ];
  private ListInfos: ListItemInfo[] = [
    {
      image: $r('app.string.GreenParkUrl'),
      title: 'ç¿ æ¹–å…¬å›­',
      description: 'åŸå¸‚ä¸­å¿ƒçš„ç»¿æ´²ï¼Œä¼‘é—²æ•£æ­¥å¥½å»å¤„ã€‚'
    },
    {
      image: $r('app.string.LampActivityUrl'),
      title: 'åŸå¸‚æ–‡åŒ–èŠ‚',
      description: 'ä½“éªŒå½“åœ°æ–‡åŒ–ï¼Œæ„Ÿå—åŸå¸‚é­…åŠ›ã€‚'
    },
    {
      image: $r('app.string.WaterStreetUrl'),
      title: 'çœ‰å±±æ°´è¡—',
      description: 'å“å°åœ°é“å°åƒï¼Œæ„Ÿå—å·èœ€æµªæ¼«ï¼Œæ»¡è¶³æ‚¨çš„å‘³è•¾ã€‚'
    },
    {
      image: $r('app.string.BiFengGorgeUrl'),
      title: 'ç¢§å³°å³¡',
      description: 'é¢†ç•¥å¤§è‡ªç„¶é¬¼æ–§ç¥å·¥ï¼Œè§‚èµç†ŠçŒ«åŸºåœ°çš„ç§€ä¸½'
    },
    {
      image: $r('app.string.GreenMountainUrl'),
      title: 'è’™é¡¶å±±',
      description: 'æ‰¬å­æ±Ÿå¿ƒæ°´ï¼Œè’™å±±é¡¶ä¸ŠèŒ¶ã€‚åƒå¹´èŒ¶éƒ½ï¼Œä¸–ç•ŒèŒ¶å›­ï¼Œåƒç§‹è’™é¡¶ï¼Œå€¼å¾—ä¸€èµ'
    }
  ]

  aboutToAppear() {
    this.updateWidth();
  }

  onConfigurationUpdate() {
    this.updateWidth();
  }

  updateWidth() {
    const defaultDisplay = display.getDefaultDisplaySync();
    this.deviceWidth = defaultDisplay.width;
    if (this.deviceWidth >= 4200) {
      this.maxCount = 3;
    } else if (this.deviceWidth >= 2400) {
      this.maxCount = 2;
    }
  }

  build() {
    // å…³é”®æ”¹è¿›ï¼šå°†æ•´ä¸ªé¡µé¢å†…å®¹åŒ…è£¹åœ¨ Scroll ç»„ä»¶ä¸­ï¼Œç¡®ä¿é¡µé¢åœ¨å†…å®¹æº¢å‡ºæ—¶å¯ä»¥æ»šåŠ¨
    Scroll() {
      Column() {
        // æœç´¢æ 
        TextInput({ placeholder: 'æœç´¢æ™¯ç‚¹ã€æ´»åŠ¨...' })
          .width('95%')// å®½åº¦å çˆ¶å®¹å™¨çš„95%
          .height(48)// å›ºå®šé«˜åº¦
          .borderRadius(24)// åœ†è§’
          .backgroundColor(Color.White)// èƒŒæ™¯è‰²
          .padding({ left: 15, right: 15 })// å†…è¾¹è·
          .margin({ top: 15, bottom: 15 })// å¤–è¾¹è·
          .fontSize(16)// å­—ä½“å¤§å°
          .fontColor(Color.Black)// å­—ä½“é¢œè‰²
          .placeholderColor(Color.Gray)// å ä½ç¬¦é¢œè‰²
          .border({ width: 1, color: '#cbd5e1', radius: 24 })// è¾¹æ¡†
          .shadow({
            radius: 5,
            color: 'rgba(0,0,0,0.05)',
            offsetX: 0,
            offsetY: 2
          }) // é˜´å½±

        // çƒ­é—¨æ¨è - Swiper è½®æ’­å›¾
        Text('çƒ­é—¨æ¨è')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor('#334155')
          .alignSelf(ItemAlign.Start)// å·¦å¯¹é½
          .margin({ left: '2.5%', bottom: 10 })// å·¦ä¾§å¤–è¾¹è·å’Œåº•éƒ¨å¤–è¾¹è·
          .padding({ left: 10 }) // å·¦ä¾§å†…è¾¹è·

        Swiper() {
          ForEach(this.recommendedImages, (item: string) => {
            Image(item)
              .width('100%')
              .height(200)
              .borderRadius(16)
              .objectFit(ImageFit.Cover) // å›¾ç‰‡è£å‰ªæ¨¡å¼
          })
        }
        .width('95%')
        .height(200)
        .indicator(true) // æ˜¾ç¤ºæŒ‡ç¤ºå™¨ï¼ˆå°åœ†ç‚¹ï¼‰
        .loop(true) // å¾ªç¯æ’­æ”¾
        .autoPlay(true) // è‡ªåŠ¨æ’­æ”¾
        .interval(3000) // æ’­æ”¾é—´éš”3ç§’
        .onChange((index: number) => {
          this.swiperIndex = index; // æ›´æ–°å½“å‰è½®æ’­å›¾ç´¢å¼•
        })
        .borderRadius(10)
        .shadow({
          radius: 8,
          color: 'rgba(0,0,0,0.1)',
          offsetX: 0,
          offsetY: 4
        }) // é˜´å½±
        .margin({ bottom: 20 }) // åº•éƒ¨å¤–è¾¹è·

        // çƒ­é—¨åˆ†ç±» - GridRow (å“åº”å¼ç½‘æ ¼å¸ƒå±€)
        Text('çƒ­é—¨åˆ†ç±»')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor('#334155')
          .alignSelf(ItemAlign.Start)
          .margin({ left: '2.5%', bottom: 10 })
          .padding({ left: 10 })

        GridRow({
          columns: 12, // ArkUI GridRow é»˜è®¤æ€»åˆ—æ•°ä¸º12ï¼Œè¿™é‡Œæ˜¾å¼å£°æ˜ä»¥æé«˜å¯è¯»æ€§
          gutter: { x: 10, y: 10 } // ç½‘æ ¼é¡¹ä¹‹é—´çš„é—´è·
        }) {
          // æ‰‹æœºçª„å± (xs): æ¯è¡Œ 2 åˆ— (æ¯ä¸ªå  6/12 å®½åº¦)
          // æŠ˜å å®½å± (md): æ¯è¡Œ 4 åˆ— (æ¯ä¸ªå  3/12 å®½åº¦)
          // å¹³æ¿å¤§å± (lg): æ¯è¡Œ 6 åˆ— (æ¯ä¸ªå  2/12 å®½åº¦)
          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) { // xs for extra small (phone), md for medium (tablet)
            CategoryItem({ icon: 'ğŸï¸', text: 'æ™¯ç‚¹' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ‰', text: 'æ´»åŠ¨' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ”', text: 'ç¾é£Ÿ' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ¨', text: 'ä½å®¿' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ›ï¸', text: 'è´­ç‰©' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸšŒ', text: 'äº¤é€š' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ—ºï¸', text: 'è·¯çº¿' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ“±', text: 'æ¸¸æˆ' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ€', text: 'è‡ªç„¶' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ–ï¸', text: 'æµ·æ™¯' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'ğŸ’–', text: 'é™…é‡' })
          }

          GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
            CategoryItem({ icon: 'âœ¨', text: 'æ›´å¤š' })
          }
        }
        .width('95%')
        .margin({ bottom: 20 })

        // ç²¾é€‰æ¨è - List (åˆ—è¡¨å±•ç¤º)
        Text('ç²¾é€‰æ¨è')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor('#334155')
          .alignSelf(ItemAlign.Start)
          .margin({ left: '2.5%', bottom: 10 })
          .padding({ left: 10 })

        GridRow({
          columns: 6,
          gutter: { x: 10, y: 10 }
        }) {
          ForEach(this.ListInfos, (item: ListItemInfo) => {
            GridCol({ span: { xs: 6, md: 3, lg: 2 } }) {
              RecommendedItem({
                image: item.image,
                title: item.title,
                description: item.description
              })
            }
          })
        }
        .margin({ left: '2.5%', right: '2.5%' })

        // List() {
        //   ListItem() {
        //     RecommendedItem({
        //       image: $r('app.string.GreenParkUrl'),
        //       title: 'ç¿ æ¹–å…¬å›­',
        //       description: 'åŸå¸‚ä¸­å¿ƒçš„ç»¿æ´²ï¼Œä¼‘é—²æ•£æ­¥å¥½å»å¤„ã€‚'
        //     })
        //   }
        //
        //   ListItem() {
        //     RecommendedItem({
        //       image: $r('app.string.LampActivityUrl'),
        //       title: 'åŸå¸‚æ–‡åŒ–èŠ‚',
        //       description: 'ä½“éªŒå½“åœ°æ–‡åŒ–ï¼Œæ„Ÿå—åŸå¸‚é­…åŠ›ã€‚'
        //     })
        //   }
        //
        //   ListItem() {
        //     RecommendedItem({
        //       image: $r('app.string.WaterStreetUrl'),
        //       title: 'çœ‰å±±æ°´è¡—',
        //       description: 'å“å°åœ°é“å°åƒï¼Œæ„Ÿå—å·èœ€æµªæ¼«ï¼Œæ»¡è¶³æ‚¨çš„å‘³è•¾ã€‚'
        //     })
        //   }
        //
        //   ListItem() {
        //     RecommendedItem({
        //       image: $r('app.string.BiFengGorgeUrl'),
        //       title: 'ç¢§å³°å³¡',
        //       description: 'é¢†ç•¥å¤§è‡ªç„¶é¬¼æ–§ç¥å·¥ï¼Œè§‚èµç†ŠçŒ«åŸºåœ°çš„ç§€ä¸½'
        //     })
        //   }
        //
        //   ListItem() {
        //     RecommendedItem({
        //       image: $r('app.string.GreenMountainUrl'),
        //       title: 'è’™é¡¶å±±',
        //       description: 'æ‰¬å­æ±Ÿå¿ƒæ°´ï¼Œè’™å±±é¡¶ä¸ŠèŒ¶ã€‚åƒå¹´èŒ¶éƒ½ï¼Œä¸–ç•ŒèŒ¶å›­ï¼Œåƒç§‹è’™é¡¶ï¼Œå€¼å¾—ä¸€èµ'
        //     })
        //   }
        // }
        // .width('95%')
        // // åœ¨ Scroll ç»„ä»¶å†…éƒ¨ï¼ŒList çš„é«˜åº¦ä¼šæ ¹æ®å…¶å†…å®¹è‡ªé€‚åº”ï¼Œé€šå¸¸ä¸éœ€è¦è®¾ç½® layoutWeight(1)
        // // .layoutWeight(1)
        // .listDirection(Axis.Vertical) // å‚ç›´åˆ—è¡¨
        // .divider({ strokeWidth: 0, color: Color.Transparent }) // æ— åˆ†éš”çº¿
        // .scrollBar(BarState.Off) // å…³é—­åˆ—è¡¨è‡ªèº«çš„æ»šåŠ¨æ¡
      }
      .width('100%') // Column å®½åº¦å¡«å…… Scroll
      // åœ¨ Scroll ç»„ä»¶å†…éƒ¨ï¼ŒColumn çš„é«˜åº¦ä¸éœ€è¦å›ºå®šä¸º100%ï¼Œå®ƒä¼šæ ¹æ®å†…å®¹è‡ªé€‚åº”
      // .height('100%')
      .backgroundColor('#f0f4f8') // è½»æŸ”çš„èƒŒæ™¯è‰²
      .padding({ bottom: 20 }) // åº•éƒ¨ç•™ç™½ï¼Œé˜²æ­¢å†…å®¹è¢«åº•éƒ¨å¯¼èˆªæ é®æŒ¡
    }
    .width('100%')
    .height('100%')
    .scrollBar(BarState.Off) // éšè— Scroll ç»„ä»¶çš„æ»šåŠ¨æ¡
  }
}

@Component
struct ListView {
  @State tab_index: number = 0;
  @Prop data: ListItemInfo[];
  @Prop maxCount: number = 3;
  @Prop rowCount: number = Math.ceil(this.data.length / this.maxCount);

  build() {
    // List() {
    //   // éå†æ¯ä¸€â€œè¡Œâ€
    //   ForEach(Array(this.rowCount).fill(0), (rowIndex: number) => {
    //     ListItem() {
    //       Row({ space: 10 }) {
    //         // å½“å‰è¡Œçš„æ‰€æœ‰åˆ—
    //         ForEach(this.data.slice(rowIndex * this.maxCount, (rowIndex + 1) * this.maxCount), (item: ListItemInfo) => {
    //           ListItem() {
    //             RecommendedItem({
    //               image: item.image,
    //               title: item.title,
    //               description: item.description
    //             })
    //           }
    //           .width(`${100 / this.maxCount}%`) // å¹³å‡åˆ†é…å®½åº¦
    //         })
    //       }
    //     }
    //   })
    // }

  }
}

// çƒ­é—¨åˆ†ç±»é¡¹ç»„ä»¶
@Component
struct CategoryItem {
  private icon: string = '';
  private text: string = '';

  build() {
    Column() {
      Text(this.icon)
        .fontSize(36)
        .margin({ bottom: 8 })

      Text(this.text)
        .fontSize(16)
        .fontColor(Color.Black)
    }
    .width('100%')
    .height(120)
    .backgroundColor(Color.White)
    .borderRadius(12)
    .shadow({
      radius: 4,
      color: Color.Gray,
      offsetX: 0,
      offsetY: 2
    })
    .justifyContent(FlexAlign.Center)
    .onClick(() => {
      Prompt.showToast({
        message: `ç‚¹å‡»äº†ï¼š${this.text}`
      })
    })
  }
}

// ç²¾é€‰æ¨èé¡¹ç»„ä»¶
@Component
struct RecommendedItem {
  private image: Resource = $r('app.string.module_desc');
  private title: string = '';
  private description: string = '';

  build() {
    Row() {
      Image(this.image)
        .width(80)
        .height(80)
        .borderRadius(6)
        .objectFit(ImageFit.Cover)
        .margin({ right: 15 })

      Column() {
        Text(this.title)
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .fontColor('#1f2937')
          .alignSelf(ItemAlign.Start)// å·¦å¯¹é½
          .margin({ bottom: 5 })
        Text(this.description)
          .fontSize(14)
          .fontColor('#4b5563')
          .alignSelf(ItemAlign.Start) // å·¦å¯¹é½
      }
      .alignItems(HorizontalAlign.Start) // å­ç»„ä»¶æ°´å¹³å·¦å¯¹é½
      .layoutWeight(1) // å…è®¸å†…å®¹å¡«å……å‰©ä½™ç©ºé—´
    }
    .width('100%')
    .padding(15)
    .backgroundColor(Color.White)
    .borderRadius(10)
    .shadow({
      radius: 5,
      color: 'rgba(0,0,0,0.05)',
      offsetX: 0,
      offsetY: 2
    }) // é˜´å½±
    .margin({ bottom: 10 }) // åº•éƒ¨å¤–è¾¹è·
  }
}
